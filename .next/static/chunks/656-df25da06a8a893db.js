(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[656],{4656:function(e,t,a){Promise.resolve().then(a.bind(a,4680))},4680:function(e,t,a){"use strict";a.d(t,{default:function(){return X}});var s=a(7437),r=a(1014),l=a(9343),i=a(9772),o=a(2265),n=a(5280),d=a(2421),c=a(4392),u=a(2468),m=a(7440);let f=n.fC;n.ZA;let p=n.B4,h=o.forwardRef((e,t)=>{let{className:a,children:r,...l}=e;return(0,s.jsxs)(n.xz,{ref:t,className:(0,m.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...l,children:[r,(0,s.jsx)(n.JO,{asChild:!0,children:(0,s.jsx)(d.Z,{className:"h-4 w-4 opacity-50"})})]})});h.displayName=n.xz.displayName;let x=o.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.u_,{ref:t,className:(0,m.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,s.jsx)(c.Z,{className:"h-4 w-4"})})});x.displayName=n.u_.displayName;let g=o.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.$G,{ref:t,className:(0,m.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,s.jsx)(d.Z,{className:"h-4 w-4"})})});g.displayName=n.$G.displayName;let b=o.forwardRef((e,t)=>{let{className:a,children:r,position:l="popper",...i}=e;return(0,s.jsx)(n.h_,{children:(0,s.jsxs)(n.VY,{ref:t,className:(0,m.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,...i,children:[(0,s.jsx)(x,{}),(0,s.jsx)(n.l_,{className:(0,m.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,s.jsx)(g,{})]})})});b.displayName=n.VY.displayName,o.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.__,{ref:t,className:(0,m.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...r})}).displayName=n.__.displayName;let v=o.forwardRef((e,t)=>{let{className:a,children:r,...l}=e;return(0,s.jsxs)(n.ck,{ref:t,className:(0,m.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,s.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(n.wU,{children:(0,s.jsx)(u.Z,{className:"h-4 w-4"})})}),(0,s.jsx)(n.eT,{children:r})]})});v.displayName=n.ck.displayName,o.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(n.Z0,{ref:t,className:(0,m.cn)("-mx-1 my-1 h-px bg-muted",a),...r})}).displayName=n.Z0.displayName;var j=a(495),N=a(1538),y=a(8364);let w=(0,a(2218).j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),I=o.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(y.f,{ref:t,className:(0,m.cn)(w(),a),...r})});I.displayName=y.f.displayName;let _=l.RV,R=o.createContext({}),S=e=>{let{...t}=e;return(0,s.jsx)(R.Provider,{value:{name:t.name},children:(0,s.jsx)(l.Qr,{...t})})},T=()=>{let e=o.useContext(R),t=o.useContext(C),{getFieldState:a,formState:s}=(0,l.Gc)(),r=a(e.name,s);if(!e)throw Error("useFormField should be used within <FormField>");let{id:i}=t;return{id:i,name:e.name,formItemId:"".concat(i,"-form-item"),formDescriptionId:"".concat(i,"-form-item-description"),formMessageId:"".concat(i,"-form-item-message"),...r}},C=o.createContext({}),k=o.forwardRef((e,t)=>{let{className:a,...r}=e,l=o.useId();return(0,s.jsx)(C.Provider,{value:{id:l},children:(0,s.jsx)("div",{ref:t,className:(0,m.cn)("space-y-2",a),...r})})});k.displayName="FormItem";let A=o.forwardRef((e,t)=>{let{className:a,...r}=e,{error:l,formItemId:i}=T();return(0,s.jsx)(I,{ref:t,className:(0,m.cn)(l&&"text-destructive",a),htmlFor:i,...r})});A.displayName="FormLabel";let O=o.forwardRef((e,t)=>{let{...a}=e,{error:r,formItemId:l,formDescriptionId:i,formMessageId:o}=T();return(0,s.jsx)(N.g7,{ref:t,id:l,"aria-describedby":r?"".concat(i," ").concat(o):"".concat(i),"aria-invalid":!!r,...a})});O.displayName="FormControl",o.forwardRef((e,t)=>{let{className:a,...r}=e,{formDescriptionId:l}=T();return(0,s.jsx)("p",{ref:t,id:l,className:(0,m.cn)("text-sm text-muted-foreground",a),...r})}).displayName="FormDescription";let z=o.forwardRef((e,t)=>{let{className:a,children:r,...l}=e,{error:i,formMessageId:o}=T(),n=i?String(null==i?void 0:i.message):r;return n?(0,s.jsx)("p",{ref:t,id:o,className:(0,m.cn)("text-sm font-medium text-destructive",a),...l,children:n}):null});z.displayName="FormMessage";var E=a(3102),F=a(3146);let D=e=>{let{control:t,render:a,name:r,formLabel:l,className:i}=e;return(0,s.jsx)(S,{control:t,name:r,render:e=>{let{field:t}=e;return(0,s.jsxs)(k,{className:i,children:[l&&(0,s.jsx)(A,{children:l}),(0,s.jsx)(O,{children:a({field:t})}),(0,s.jsx)(z,{})]})}})};var M=a(311),V=a(4061),L=a(6648),P=e=>{let{onValueChange:t,setImage:a,image:r,publicId:l,type:i}=e,{toast:o}=(0,M.pm)();return(0,s.jsx)(V.ZF,{uploadPreset:"jsm_imaginify",options:{multiple:!1,resourceType:"image"},onSuccess:e=>{var s;a(t=>{var a,s,r,l;return{...t,publicId:null==e?void 0:null===(a=e.info)||void 0===a?void 0:a.public_id,width:null==e?void 0:null===(s=e.info)||void 0===s?void 0:s.width,height:null==e?void 0:null===(r=e.info)||void 0===r?void 0:r.height,secureURL:null==e?void 0:null===(l=e.info)||void 0===l?void 0:l.secure_url}}),t(null==e?void 0:null===(s=e.info)||void 0===s?void 0:s.public_id),o({title:"Image uploaded successfully",description:"1 credit was deducted from your account",duration:5e3,className:"success-toast"})},onError:()=>{o({title:"Something went wrong while uploading",description:"Please try again",duration:5e3,className:"error-toast"})},children:e=>{let{open:t}=e;return(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsx)("h3",{className:"h3-bold text-dark-600",children:"Original"}),l?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"cursor-pointer overflow-hidden rounded-[10px]",children:(0,s.jsx)(V.bz,{width:(0,m.Ad)(i,r,"width"),height:(0,m.Ad)(i,r,"height"),src:l,alt:"image",sizes:"(max-width: 767px) 100vw, 50vw",placeholder:m.c8,className:"media-uploader_cldImage"})})}):(0,s.jsxs)("div",{className:"media-uploader_cta",onClick:()=>t(),children:[(0,s.jsx)("div",{className:"media-uploader_cta-image",children:(0,s.jsx)(L.default,{src:"/assets/icons/add.svg",alt:"Add Image",width:24,height:24})}),(0,s.jsx)("p",{className:"p-14-medium",children:"Click here to upload image"})]})]})}})},U=a(7676);a(4590);var Z=a(8064),$=(0,Z.$)("b2a90d281b61f0fd63dfa5008fbcac295a6ae37e");(0,Z.$)("15b7832004d701c5edee6144e0c0c9d9747cc984"),(0,Z.$)("2bfdc0e17c58ceb98c26f4cd1b2677c7816e8b39"),(0,Z.$)("1d575876d1821b9744f489231b3e5c1c6be08015"),(0,Z.$)("6211d5ae95a8c8bbe21c848c64603161c69b5fa8");var G=a(8387),Y=a(6463),B=a(6780);let J=()=>{let e=(0,Y.useRouter)();return(0,s.jsx)(B.aR,{defaultOpen:!0,children:(0,s.jsxs)(B._T,{children:[(0,s.jsxs)(B.fY,{children:[(0,s.jsxs)("div",{className:"flex-between",children:[(0,s.jsx)("p",{className:"p-16-semibold text-dark-400",children:"Insufficient Credits"}),(0,s.jsx)(B.le,{className:"border-0 p-0 hover:bg-transparent",onClick:()=>e.push("/profile"),children:(0,s.jsx)(L.default,{src:"/assets/icons/close.svg",alt:"credit coins",width:24,height:24,className:"cursor-pointer"})})]}),(0,s.jsx)(L.default,{src:"/assets/images/stacked-coins.png",alt:"credit coins",width:462,height:122}),(0,s.jsx)(B.f$,{className:"p-24-bold text-dark-600",children:"Oops.... Looks like you've run out of free credits!"}),(0,s.jsx)(B.yT,{className:"p-16-regular py-3",children:"No worries, though - you can keep enjoying our services by grabbing more credits."})]}),(0,s.jsxs)(B.xo,{children:[(0,s.jsx)(B.le,{className:"button w-full bg-purple-100 text-dark-400",onClick:()=>e.push("/profile"),children:"No, Cancel"}),(0,s.jsx)(B.OL,{className:"button w-full bg-purple-gradient  bg-cover",onClick:()=>e.push("/credits"),children:"Yes, Proceed"})]})]})})},Q=i.z.object({title:i.z.string(),aspectRatio:i.z.string().optional(),color:i.z.string().optional(),prompt:i.z.string().optional(),publicId:i.z.string()});var X=e=>{let{action:t,data:a=null,userId:i,type:n,creditBalance:d,config:c=null}=e,u=F.vB[n],[x,g]=(0,o.useState)(a),[N,y]=(0,o.useState)(null),[w,I]=(0,o.useState)(!1),[R,S]=(0,o.useState)(!1),[T,C]=(0,o.useState)(c),[k,A]=(0,o.useTransition)(),O=(0,Y.useRouter)(),z=a&&"Update"===t?{title:null==a?void 0:a.title,aspectRatio:null==a?void 0:a.aspectRatio,color:null==a?void 0:a.color,prompt:null==a?void 0:a.prompt,publicId:null==a?void 0:a.publicId}:F.Pg,M=(0,l.cI)({resolver:(0,r.F)(Q),defaultValues:z});async function L(e){if(I(!0),a||x){let s=(0,V.oy)({width:null==x?void 0:x.width,height:null==x?void 0:x.height,src:null==x?void 0:x.publicId,...T}),r={title:e.title,publicId:null==x?void 0:x.publicId,transformationType:n,width:null==x?void 0:x.width,height:null==x?void 0:x.height,config:T,secureURL:null==x?void 0:x.secureURL,transformationURL:s,aspectRatio:e.aspectRatio,prompt:e.prompt,color:e.color};if("Add"===t)try{let e=await (0,G.mN)({image:r,userId:i,path:"/"});e&&(M.reset(),g(a),O.push("/transformations/".concat(e._id)))}catch(e){console.log(e)}if("Update"===t)try{let e=await (0,G.gO)({image:{...r,_id:a._id},userId:i,path:"/transformations/".concat(a._id)});e&&O.push("/transformations/".concat(e._id))}catch(e){console.log(e)}}I(!1)}let Z=(e,t)=>{let a=F.V3[e];return g(e=>({...e,aspectRatio:a.aspectRatio,width:a.width,height:a.height})),y(u.config),t(e)},B=(e,t,a,s)=>((0,m.Ds)(()=>{y(s=>({...s,[a]:{...null==s?void 0:s[a],["prompt"===e?"prompt":"to"]:t}}))},1e3)(),s(t)),X=async()=>{S(!0),C((0,m.ho)(N,T)),y(null),A(async()=>{await $(i,F.Mg)})};return(0,o.useEffect)(()=>{x&&("restore"===n||"removeBackground"===n)&&y(u.config)},[x,u.config,n]),(0,s.jsx)(_,{...M,children:(0,s.jsxs)("form",{onSubmit:M.handleSubmit(L),className:"space-y-8",children:[d<Math.abs(F.Mg)&&(0,s.jsx)(J,{}),(0,s.jsx)(D,{control:M.control,name:"title",formLabel:"Image Title",className:"w-full",render:e=>{let{field:t}=e;return(0,s.jsx)(E.I,{...t,className:"input-field"})}}),"fill"===n&&(0,s.jsx)(D,{control:M.control,name:"aspectRatio",formLabel:"Aspect Ratio",className:"w-full",render:e=>{let{field:t}=e;return(0,s.jsxs)(f,{onValueChange:e=>Z(e,t.onChange),value:t.value,children:[(0,s.jsx)(h,{className:"select-field",children:(0,s.jsx)(p,{placeholder:"Select size"})}),(0,s.jsx)(b,{children:Object.keys(F.V3).map(e=>(0,s.jsx)(v,{value:e,className:"select-item",children:F.V3[e].label},e))})]})}}),("remove"===n||"recolor"===n)&&(0,s.jsxs)("div",{className:"prompt-field",children:[(0,s.jsx)(D,{control:M.control,name:"prompt",formLabel:"remove"===n?"Object to remove":"Object to recolor",className:"w-full",render:e=>{let{field:t}=e;return(0,s.jsx)(E.I,{value:t.value,className:"input-field",onChange:e=>B("prompt",e.target.value,n,t.onChange)})}}),"recolor"===n&&(0,s.jsx)(D,{control:M.control,name:"color",formLabel:"Replacement Color",className:"w-full",render:e=>{let{field:t}=e;return(0,s.jsx)(E.I,{value:t.value,className:"input-field",onChange:e=>B("color",e.target.value,"recolor",t.onChange)})}})]}),(0,s.jsxs)("div",{className:"media-uploader-field",children:[(0,s.jsx)(D,{control:M.control,name:"publicId",className:"flex size-full flex-col",render:e=>{let{field:t}=e;return(0,s.jsx)(P,{onValueChange:t.onChange,setImage:g,publicId:t.value,image:x,type:n})}}),(0,s.jsx)(U.default,{image:x,type:n,title:M.getValues().title,isTransforming:R,setIsTransforming:S,transformationConfig:T})]}),(0,s.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,s.jsx)(j.z,{type:"button",className:"submit-button capitalize",disabled:R||null===N,onClick:X,children:R?"Transforming...":"Apply Transformation"}),(0,s.jsx)(j.z,{type:"submit",className:"submit-button capitalize",disabled:w,children:w?"Submitting...":"Save Image"})]})]})})}},3102:function(e,t,a){"use strict";a.d(t,{I:function(){return i}});var s=a(7437),r=a(2265),l=a(7440);let i=r.forwardRef((e,t)=>{let{className:a,type:r,...i}=e;return(0,s.jsx)("input",{type:r,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:t,...i})});i.displayName="Input"},311:function(e,t,a){"use strict";a.d(t,{pm:function(){return m}});var s=a(2265);let r=0,l=new Map,i=e=>{if(l.has(e))return;let t=setTimeout(()=>{l.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);l.set(e,t)},o=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?i(a):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},n=[],d={toasts:[]};function c(e){d=o(d,e),n.forEach(e=>{e(d)})}function u(e){let{...t}=e,a=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>c({type:"DISMISS_TOAST",toastId:a});return c({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||s()}}}),{id:a,dismiss:s,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function m(){let[e,t]=s.useState(d);return s.useEffect(()=>(n.push(t),()=>{let e=n.indexOf(t);e>-1&&n.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}}}]);