(()=>{var e={};e.id=72,e.ids=[72],e.modules={11185:e=>{"use strict";e.exports=require("mongoose")},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},6113:e=>{"use strict";e.exports=require("crypto")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},6005:e=>{"use strict";e.exports=require("node:crypto")},71017:e=>{"use strict";e.exports=require("path")},63477:e=>{"use strict";e.exports=require("querystring")},12781:e=>{"use strict";e.exports=require("stream")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},380:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>c.a,__next_app__:()=>f,originalPathname:()=>u,pages:()=>l,routeModule:()=>b,tree:()=>o}),a(88471),a(79223),a(35866),a(11506);var r=a(23191),i=a(88716),n=a(37922),c=a.n(n),d=a(95231),s={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(s[e]=()=>d[e]);a.d(t,s);let o=["",{children:["(root)",{children:["transformations",{children:["[id]",{children:["update",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,88471)),"C:\\Users\\admin\\Desktop\\imaginify\\app\\(root)\\transformations\\[id]\\update\\page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,79223)),"C:\\Users\\admin\\Desktop\\imaginify\\app\\(root)\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,11506)),"C:\\Users\\admin\\Desktop\\imaginify\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],l=["C:\\Users\\admin\\Desktop\\imaginify\\app\\(root)\\transformations\\[id]\\update\\page.tsx"],u="/(root)/transformations/[id]/update/page",f={require:a,loadChunk:()=>Promise.resolve()},b=new r.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/(root)/transformations/[id]/update/page",pathname:"/transformations/[id]/update",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},68631:(e,t,a)=>{let r={"15b7832004d701c5edee6144e0c0c9d9747cc984":()=>Promise.resolve().then(a.bind(a,23149)).then(e=>e.createUser),"1d575876d1821b9744f489231b3e5c1c6be08015":()=>Promise.resolve().then(a.bind(a,23149)).then(e=>e.updateUser),"2bfdc0e17c58ceb98c26f4cd1b2677c7816e8b39":()=>Promise.resolve().then(a.bind(a,23149)).then(e=>e.getUserById),"6211d5ae95a8c8bbe21c848c64603161c69b5fa8":()=>Promise.resolve().then(a.bind(a,23149)).then(e=>e.deleteUser),b2a90d281b61f0fd63dfa5008fbcac295a6ae37e:()=>Promise.resolve().then(a.bind(a,23149)).then(e=>e.updateCredits),"0513dc1fa89a5a46cde460b345d3342f9b446570":()=>Promise.resolve().then(a.bind(a,61627)).then(e=>e.updateImage),"50467022347929ec652df885771661f8ce0b69cc":()=>Promise.resolve().then(a.bind(a,61627)).then(e=>e.deleteImage),"5bde9f216a7cdc6f58cb07f53e83b3e1738d68ea":()=>Promise.resolve().then(a.bind(a,61627)).then(e=>e.getUserImages),"78171ba2a30bc64fa482625bc3575e35f9b7eca2":()=>Promise.resolve().then(a.bind(a,61627)).then(e=>e.addImage),c2dc3af0312e83d3bbe5d4a259d4a503bdfc8574:()=>Promise.resolve().then(a.bind(a,61627)).then(e=>e.getAllImages),f6aa02c24d3e44009875e580eeee780816c3a94a:()=>Promise.resolve().then(a.bind(a,61627)).then(e=>e.getImageById)};async function i(e,...t){return(await r[e]()).apply(null,t)}e.exports={"15b7832004d701c5edee6144e0c0c9d9747cc984":i.bind(null,"15b7832004d701c5edee6144e0c0c9d9747cc984"),"1d575876d1821b9744f489231b3e5c1c6be08015":i.bind(null,"1d575876d1821b9744f489231b3e5c1c6be08015"),"2bfdc0e17c58ceb98c26f4cd1b2677c7816e8b39":i.bind(null,"2bfdc0e17c58ceb98c26f4cd1b2677c7816e8b39"),"6211d5ae95a8c8bbe21c848c64603161c69b5fa8":i.bind(null,"6211d5ae95a8c8bbe21c848c64603161c69b5fa8"),b2a90d281b61f0fd63dfa5008fbcac295a6ae37e:i.bind(null,"b2a90d281b61f0fd63dfa5008fbcac295a6ae37e"),"0513dc1fa89a5a46cde460b345d3342f9b446570":i.bind(null,"0513dc1fa89a5a46cde460b345d3342f9b446570"),"50467022347929ec652df885771661f8ce0b69cc":i.bind(null,"50467022347929ec652df885771661f8ce0b69cc"),"5bde9f216a7cdc6f58cb07f53e83b3e1738d68ea":i.bind(null,"5bde9f216a7cdc6f58cb07f53e83b3e1738d68ea"),"78171ba2a30bc64fa482625bc3575e35f9b7eca2":i.bind(null,"78171ba2a30bc64fa482625bc3575e35f9b7eca2"),c2dc3af0312e83d3bbe5d4a259d4a503bdfc8574:i.bind(null,"c2dc3af0312e83d3bbe5d4a259d4a503bdfc8574"),f6aa02c24d3e44009875e580eeee780816c3a94a:i.bind(null,"f6aa02c24d3e44009875e580eeee780816c3a94a")}},67243:(e,t,a)=>{let r={"0306281f5cf137461319ce7861d8d005fbc9ad41":()=>Promise.resolve().then(a.bind(a,3479)).then(e=>e.invalidateCacheAction)};async function i(e,...t){return(await r[e]()).apply(null,t)}e.exports={"0306281f5cf137461319ce7861d8d005fbc9ad41":i.bind(null,"0306281f5cf137461319ce7861d8d005fbc9ad41")}},88471:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var r=a(19510),i=a(78459),n=a(58585),c=a(46276),d=a(64396),s=a(68122),o=a(23149),l=a(61627);let u=async({params:{id:e}})=>{let{userId:t}=(0,i.I)();t||(0,n.redirect)("/sign-in");let a=await (0,o.getUserById)(t),u=await (0,l.getImageById)(e),f=s.vB[u.transformationType];return(0,r.jsxs)(r.Fragment,{children:[r.jsx(c.Z,{title:f.title,subtitle:f.subTitle}),r.jsx("section",{className:"mt-10",children:r.jsx(d.ZP,{action:"Update",userId:a._id,type:u.transformationType,creditBalance:a.creditBalance,config:u.config,data:u})})]})}},61627:(e,t,a)=>{"use strict";a.r(t),a.d(t,{addImage:()=>m,deleteImage:()=>g,getAllImages:()=>x,getImageById:()=>y,getUserImages:()=>v,updateImage:()=>h});var r=a(24330);a(60166);var i=a(57708),n=a(18879),c=a(50650),d=a(29258),s=a(11185);let o=new s.Schema({title:{type:String,required:!0},transformationType:{type:String,required:!0},publicId:{type:String,required:!0},secureURL:{type:String,required:!0},width:{type:Number},height:{type:Number},config:{type:Object},transformationUrl:{type:String},aspectRatio:{type:String},color:{type:String},prompt:{type:String},author:{type:s.Schema.Types.ObjectId,ref:"User"},createdAt:{type:Date,default:Date.now},updatedAt:{type:Date,default:Date.now}}),l=s.models?.Image||(0,s.model)("Image",o);var u=a(58585),f=a(49788),b=a(40618);let p=e=>e.populate({path:"author",model:d.Z,select:"_id firstName lastName clerkId"});async function m({image:e,userId:t,path:a}){try{await (0,n.v)();let r=await d.Z.findById(t);if(!r)throw Error("User not found");let c=await l.create({...e,author:r._id});return(0,i.revalidatePath)(a),JSON.parse(JSON.stringify(c))}catch(e){(0,c.S3)(e)}}async function h({image:e,userId:t,path:a}){try{await (0,n.v)();let r=await l.findById(e._id);if(!r||r.author.toHexString()!==t)throw Error("Unauthorized or image not found");let c=await l.findByIdAndUpdate(r._id,e,{new:!0});return(0,i.revalidatePath)(a),JSON.parse(JSON.stringify(c))}catch(e){(0,c.S3)(e)}}async function g(e){try{await (0,n.v)(),await l.findByIdAndDelete(e)}catch(e){(0,c.S3)(e)}finally{(0,u.redirect)("/")}}async function y(e){try{await (0,n.v)();let t=await p(l.findById(e));if(!t)throw Error("Image not found");return JSON.parse(JSON.stringify(t))}catch(e){(0,c.S3)(e)}}async function x({limit:e=9,page:t=1,searchQuery:a=""}){try{await (0,n.v)(),f.v2.config({cloud_name:"dk8currrj",api_key:process.env.CLOUDINARY_API_KEY,api_secret:process.env.CLOUDINARY_API_SECRET,secure:!0});let r="folder=imaginify";a&&(r+=` AND ${a}`);let{resources:i}=await f.v2.search.expression(r).execute(),c=i.map(e=>e.public_id),d={};a&&(d={publicId:{$in:c}});let s=(Number(t)-1)*e,o=await p(l.find(d)).sort({updatedAt:-1}).skip(s).limit(e),u=await l.find(d).countDocuments(),b=await l.find().countDocuments();return{data:JSON.parse(JSON.stringify(o)),totalPage:Math.ceil(u/e),savedImages:b}}catch(e){(0,c.S3)(e)}}async function v({limit:e=9,page:t=1,userId:a}){try{await (0,n.v)();let r=(Number(t)-1)*e,i=await p(l.find({author:a})).sort({updatedAt:-1}).skip(r).limit(e),c=await l.find({author:a}).countDocuments();return{data:JSON.parse(JSON.stringify(i)),totalPages:Math.ceil(c/e)}}catch(e){(0,c.S3)(e)}}(0,b.h)([m,h,g,y,x,v]),(0,r.j)("78171ba2a30bc64fa482625bc3575e35f9b7eca2",m),(0,r.j)("0513dc1fa89a5a46cde460b345d3342f9b446570",h),(0,r.j)("50467022347929ec652df885771661f8ce0b69cc",g),(0,r.j)("f6aa02c24d3e44009875e580eeee780816c3a94a",y),(0,r.j)("c2dc3af0312e83d3bbe5d4a259d4a503bdfc8574",x),(0,r.j)("5bde9f216a7cdc6f58cb07f53e83b3e1738d68ea",v)}};var t=require("../../../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[948,625,985,71,562,621,70,870,788,357,703,446],()=>a(380));module.exports=r})();